# -*- coding: utf-8 -*-
"""バージョン情報管理"""

from pathlib import Path

__version__ = "1.5.0"
__version_info__ = (1, 5, 0)

# リリースノート
RELEASE_NOTES = {
    "1.5.0": [
        "印刷プレビュー機能を完全実装（QWebEngineViewベース）",
        "エクスポート後のファイル自動オープン機能を修正（プラットフォーム対応）",
        "プロジェクト名変更機能を追加（編集メニュー）",
        "問題タブ名変更機能を追加（ダブルクリック）",
        "プレビューエラーハンドリングを改善",
        "印刷プレビューに表紙・問題・解答用紙の設定を反映",
    ],
    "1.4.0": [
        "UNDO/REDO機能を実装（Ctrl+Z / Ctrl+Y）",
        "印刷設定ダイアログを実装（用紙サイズ、余白、オプション）",
        "編集メニューに切り取り/コピー/貼り付け機能を追加",
        "ツールバーにUNDO/REDOボタンを追加",
        "タブ切り替え時にUNDO/REDO状態を自動更新",
    ],
    "1.3.0": [
        "数式エディタを実装（ビジュアルLaTeXエディタ）",
        "5つのタブで数式記号を簡単挿入（基本、演算子、ギリシャ文字、関数、その他）",
        "MathJaxによるリアルタイムプレビュー機能",
        "インライン数式とディスプレイ数式の切り替え対応",
    ],
    "1.2.0": [
        "外部スクリプト実行のタイムアウト撤廃（無制限実行可能）",
        "3つすべての外部スクリプトがツールバーに表示されるように修正",
        "スクリプトメニューのクロージャ問題を修正",
        "長時間実行スクリプトに対応",
    ],
    "1.1.0": [
        "問題に配点フィールドを追加",
        "HTMLエクスポートのレイアウト改善（日本語問題番号、配点表示）",
        "表紙データのJSON保存/読み込み修正",
        "数式表示のスタイル改善",
        "必答・選択の区別機能（実装予定）",
        "解答欄自動生成機能（実装予定）",
        "PDF直接出力機能（実装予定）",
        "問題並び替え機能（実装予定）",
        "画像挿入機能（実装予定）",
    ],
    "1.0.0": [
        "初回リリース",
        "プロジェクト管理（新規作成、開く、保存）",
        "表紙編集機能",
        "マークダウン問題エディタ",
        "HTML問題エディタ",
        "HTML出力機能",
        "プロンプト生成機能",
    ]
}


def get_version() -> str:
    """バージョン文字列を取得"""
    return __version__


def get_version_info() -> tuple:
    """バージョン情報タプルを取得"""
    return __version_info__


def get_release_notes(version: str = None) -> list:
    """特定バージョンのリリースノートを取得
    
    Args:
        version: バージョン文字列（Noneの場合は最新版）
    
    Returns:
        リリースノートのリスト
    """
    if version is None:
        version = __version__
    return RELEASE_NOTES.get(version, [])


def get_all_versions() -> list:
    """すべてのバージョンを取得（新しい順）"""
    versions = list(RELEASE_NOTES.keys())
    versions.sort(key=lambda v: [int(x) for x in v.split('.')], reverse=True)
    return versions
